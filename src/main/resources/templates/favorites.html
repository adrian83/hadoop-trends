<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Twitter trends :: Most favorites</title>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script type="text/javascript">

    var source = new EventSource("/sse/favorites");
    source.onmessage = function(event) {
        var newFavorites = JSON.parse(event.data);
        if(newFavorites.length > 0){
        	document.getElementById("info").innerHTML = "";
        }
        var html = "<ul class=\"list-group\">";
        for(var i=0; i < newFavorites.length; i++){
        	var hashtag = newFavorites[i];
        	var a = "<a target=\"_blank\" href=\"https://twitter.com/hashtag/" + hashtag.id + "\">" + hashtag.id + "</a>";
        	html += "<li class=\"list-group-item\"><span class=\"badge\">" + hashtag.favorite + "</span>" + a + "</li>";
        }
        html += "</ul>";
        document.getElementById("result").innerHTML = html;
    };
    source.onopen = function(event) {
    	document.getElementById("info").innerHTML = "<div class=\"alert alert-info\" role=\"alert\">Some data should appear soon.</div>";
    };

    </script>
  </head>

  <body>

    <div class="container">

      <div class="masthead">
        <h3 class="text-muted">Twitter trends</h3>
      </div>
      
      <br/>
      
      <div id="info">
      	<div class="alert alert-danger" role="alert">Waiting for connection...</div>
      </div>

	  <div id="result"></div>

    </div> 

  </body>
</html>


